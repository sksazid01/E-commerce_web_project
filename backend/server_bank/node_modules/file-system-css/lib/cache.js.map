{"version":3,"sources":["../src/cache.js"],"names":[],"mappings":";;;;;;AAAA;;;;AACA;;IAAY,I;;AACZ;;;;;;;;AAEA,IAAM,cAAc,uBAAa,OAAb,CAAqB;AACvC,SAAO,QADgC;AAEvC,OAAK,GAFkC;AAGvC,OAAM,KAAK,EAAL,GAAU,CAHuB,EAArB,CAApB;;;AAOA,IAAM,SAAS,SAAT,MAAS,CAAC,KAAD,EAAQ,OAAR,EAAoB;AACjC,MAAM,YAAY,gBAAE,IAAF,CACI,gBAAE,MADN,EAEI,gBAAE,GAAF,CAAM,gBAAE,QAAR,CAFJ,EAGI,gBAAE,MAAF,CAAS,gBAAE,KAAX,CAHJ,CAAlB;AAKA,SAAO,KAAK,IAAL,CAAU,KAAV,EAAiB,UAAU,OAAV,CAAjB,CAAP;AACD,CAPD;;;;;kBAce;AACb,OAAK,MADQ;AAEb,QAAM;AAAA,WAAM,YAAY,IAAZ,EAAN;AAAA,GAFO;AAGb,OAHa,iBAGP,GAHO,EAGF,MAHE,EAGK;AAChB,QAAI,WAAU,IAAd,EAAoB;AAAE,kBAAY,GAAZ,CAAgB,GAAhB;AAAuB;AAC7C,QAAI,WAAU,SAAd,EAAyB;AAAE,kBAAY,GAAZ,CAAgB,GAAhB,EAAqB,MAArB;AAA8B;AACzD,WAAO,YAAY,GAAZ,CAAgB,GAAhB,CAAP;AACD,GAPY;AAQb,QARa,kBAQN,GARM,EAQD;AAAE,SAAK,KAAL,CAAW,GAAX,EAAgB,IAAhB;AAAwB,GARzB;AASb,OATa,mBASL;AAAE,gBAAY,KAAZ;AAAsB;AATnB,C","file":"cache.js","sourcesContent":["import R from 'ramda';\nimport * as util from './util';\nimport cacheManager from 'cache-manager';\n\nconst memoryCache = cacheManager.caching({\n  store: 'memory',\n  max: 100,\n  ttl: (60 * 60 * 2), // Time to live: seconds => 2-hours.\n});\n\n\nconst getKey = (paths, options) => {\n  const asStrings = R.pipe(\n                        R.values,\n                        R.map(R.toString),\n                        R.reject(R.isNil)\n                      );\n  return util.hash(paths, asStrings(options));\n};\n\n\n\n/**\n * Top level cache of compiled CSS.\n */\nexport default {\n  key: getKey,\n  keys: () => memoryCache.keys(),\n  value(key, value) {\n    if (value === null) { memoryCache.del(key); }\n    if (value !== undefined) { memoryCache.set(key, value); }\n    return memoryCache.get(key);\n  },\n  remove(key) { this.value(key, null); },\n  clear() { memoryCache.reset(); },\n};\n"]}